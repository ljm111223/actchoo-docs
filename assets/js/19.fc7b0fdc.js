(window.webpackJsonp=window.webpackJsonp||[]).push([[19],{501:function(e,t,v){"use strict";v.r(t);var _=v(4),a=Object(_.a)({},(function(){var e=this,t=e.$createElement,v=e._self._c||t;return v("ContentSlotsDistributor",{attrs:{"slot-key":e.$parent.slotKey}},[v("h1",{attrs:{id:"react"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#react"}},[e._v("#")]),e._v(" React")]),e._v(" "),v("p",[e._v("[toc]")]),e._v(" "),v("h2",{attrs:{id:"问题"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#问题"}},[e._v("#")]),e._v(" 问题")]),e._v(" "),v("h3",{attrs:{id:"写-react-vue-项目时为什么要在列表组件中写-key-其作用是什么"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#写-react-vue-项目时为什么要在列表组件中写-key-其作用是什么"}},[e._v("#")]),e._v(" 写 React/ Vue 项目时为什么要在列表组件中写 key，其作用是什么")]),e._v(" "),v("p",[e._v("vue 和 react 都是"),v("strong",[e._v("采用 diff 算法来对比新旧虚拟节点")]),e._v("，从而更新节点。")]),e._v(" "),v("p",[e._v("在 vue 的 diff 函数中，在交叉对比中，当新节点跟旧节点"),v("strong",[e._v("头尾交叉对比")]),e._v("没有结果时，会根据新节点的 key 去对比旧节点数组中的 key，从而找到相应旧节点（这里对应的是一个key => index 的 map 映射）。如果没找到就认为是一个新增节点。而如果没有 key，那么就会采用"),v("strong",[e._v("遍历查找")]),e._v("的方式去找到对应的旧节点。")]),e._v(" "),v("p",[e._v("一种是 map 映射，另一种是遍历查找，相比而言，"),v("strong",[e._v("map 映射的速度更快")]),e._v("。")]),e._v(" "),v("h4",{attrs:{id:"more-key-的作用是什么"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#more-key-的作用是什么"}},[e._v("#")]),e._v(" More：key 的作用是什么")]),e._v(" "),v("p",[e._v("key 是给每一个 vnode 的唯一 id，可以依靠key，"),v("strong",[e._v("更准确、更快地拿到 oldVnode 中对应的 vnode 节点")]),e._v("。")]),e._v(" "),v("ol",[v("li",[e._v("更准确：因为带 key 就不是"),v("strong",[e._v("就地复用")]),e._v("了，在 "),v("code",[e._v("sameNode")]),e._v(" 函数 "),v("code",[e._v("a.key === b.key")]),e._v(" 对比中可以避免就地复用的情况，所以会更加准确。")]),e._v(" "),v("li",[e._v("更快：利用 key 的唯一性生成 map 对象来获取对应节点，比遍历方式更快。")])]),e._v(" "),v("h4",{attrs:{id:"某些特殊情况下的反例"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#某些特殊情况下的反例"}},[e._v("#")]),e._v(" 某些特殊情况下的反例")]),e._v(" "),v("p",[v("strong",[e._v("没有绑定 key")]),e._v("，并且在遍历"),v("strong",[e._v("模板简单")]),e._v("的情况下，会导致虚拟新旧节点对比更快，节点也会复用。而这种复用是"),v("strong",[e._v("就地复用")]),e._v("，一种"),v("strong",[e._v("鸭子辩型")]),e._v("的复用，diff 速度来看也是不带 key 更加快速的，因为带 key 在增删节点上有耗时。这就是 vue 文档所说的"),v("strong",[e._v("默认模式")]),e._v("。但是这个并不是 key 作用，而是没有 key 的情况下可以对节点"),v("strong",[e._v("就地复用")]),e._v("，提高性能。")]),e._v(" "),v("p",[e._v("这种模式会带来一些隐藏的副作用，比如可能不会产生过渡效果，或者在某些节点有绑定数据（表单）状态，会出现状态错位。")])])}),[],!1,null,null,null);t.default=a.exports}}]);